# ============================================
# BackApp Production Environment Configuration
# ============================================
#
# IMPORTANT: Copy this file to .env and fill in your values
# Command: cp .env.production.example .env
#
# For Docker Compose deployment (RECOMMENDED):
# The DATABASE_URL is automatically constructed from POSTGRES_* variables
# See docker-compose.yml for how these are used
#
# Security: Never commit .env to version control!
#

# ============================================
# Database Configuration (Docker Compose)
# ============================================
# These variables are used by docker-compose.yml to configure PostgreSQL
POSTGRES_DB=backapp
POSTGRES_USER=backapp
POSTGRES_PASSWORD=CHANGE_TO_STRONG_PASSWORD
POSTGRES_PORT=5432

# For manual deployment (non-Docker), use this instead:
# DATABASE_URL="postgresql://backapp:CHANGE_THIS_PASSWORD@localhost:5432/backapp"

# ============================================
# Application Configuration
# ============================================
NODE_ENV=production
APP_PORT=3000

# Public URL where your app is accessible (IMPORTANT!)
# This MUST match what users see in their browser
# Examples:
#   - Cloudflare Tunnel: https://backapp.davidhsells.today
#   - Local testing: http://localhost:3000
#   - Custom domain: https://yourdomain.com
NEXTAUTH_URL=https://backapp.davidhsells.today

# Secret key for NextAuth.js session encryption
# Generate with: openssl rand -base64 32
# REQUIRED: Must be a strong random string (32+ characters)
NEXTAUTH_SECRET=GENERATE_WITH_OPENSSL_RAND_BASE64_32

# ============================================
# AWS S3 Configuration
# ============================================
# AWS credentials for S3 access
# Create an IAM user with S3 access and generate access keys
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=YOUR_AWS_ACCESS_KEY_ID
AWS_SECRET_ACCESS_KEY=YOUR_AWS_SECRET_ACCESS_KEY

# S3 bucket name where backups will be stored
# Bucket must exist before deployment
AWS_S3_BUCKET=your-backup-bucket-name

# Optional: For S3-compatible services (MinIO, LocalStack)
# Leave commented for AWS S3
# AWS_S3_ENDPOINT=http://localstack:4566

# ============================================
# Email/SMTP Configuration (for alerts)
# ============================================
# SMTP server for sending email notifications
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=true

# Gmail: Use app-specific password (not your main password)
# Generate at: https://myaccount.google.com/apppasswords
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-gmail-app-password

# "From" address for outgoing emails
SMTP_FROM=BackApp <noreply@davidhsells.today>

# ============================================
# Optional: Logging Configuration
# ============================================
# Log level: error, warn, info, debug
LOG_LEVEL=info

# Enable application metrics collection
ENABLE_METRICS=true

# ============================================
# Optional: Advanced Configuration
# ============================================
# Maximum concurrent backups
MAX_CONCURRENT_BACKUPS=5

# Backup retry attempts on failure
BACKUP_RETRY_ATTEMPTS=3

# Backup timeout in minutes
BACKUP_TIMEOUT_MINUTES=60

# Encryption key for backup files (optional but recommended)
# Generate with: openssl rand -base64 32
# BACKUP_ENCRYPTION_KEY=GENERATE_WITH_OPENSSL_RAND_BASE64_32

# ============================================
# Docker Compose Notes
# ============================================
# When using Docker Compose (RECOMMENDED):
# - POSTGRES_* variables configure the PostgreSQL container
# - DATABASE_URL is automatically constructed in docker-compose.yml
# - Use 'db' as hostname (container name) in DATABASE_URL
# - Logs are stored in ./logs directory (mounted as volume)
#
# Start services: docker-compose up -d
# View logs: docker-compose logs -f app
# Stop services: docker-compose down

# ============================================
# Security Notes
# ============================================
# 1. POSTGRES_PASSWORD: Use a strong password (16+ chars, mixed case, numbers, symbols)
# 2. NEXTAUTH_SECRET: Must be random and secret (generate with openssl)
# 3. AWS credentials: Use IAM user with minimal required permissions (S3 only)
# 4. SMTP_PASSWORD: Use app-specific password, not your main email password
# 5. Never commit .env to version control! (.env is in .gitignore)
# 6. Restrict file permissions: chmod 600 .env

# ============================================
# Verification Checklist (Before Deploying)
# ============================================
# [ ] POSTGRES_PASSWORD is strong and unique
# [ ] NEXTAUTH_SECRET is generated (32+ characters): openssl rand -base64 32
# [ ] NEXTAUTH_URL matches your actual domain (with https://)
# [ ] AWS credentials are valid and have S3 access
# [ ] AWS_S3_BUCKET exists and is accessible
# [ ] SMTP credentials are correct
# [ ] All placeholder values replaced
# [ ] File saved as .env (not .env.production.example)

# ============================================
# Quick Start Commands
# ============================================
# 1. Copy this file:
#    cp .env.production.example .env
#
# 2. Generate secrets:
#    openssl rand -base64 32
#
# 3. Edit .env and fill in your values:
#    nano .env
#
# 4. Start Docker Compose:
#    docker-compose up -d
#
# 5. View logs:
#    docker-compose logs -f app
#
# For detailed instructions, see: DOCKER_DEPLOYMENT.md
